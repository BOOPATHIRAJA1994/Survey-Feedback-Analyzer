# Step 1: Preloaded Feedbacks (Given Data)
feedback_data = {
    'S_No': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    'Name': ['Ravi', 'Meera', 'Sam', 'Anu', 'Raj', 'Divya', 'Arjun', 'Kiran', 'Leela', 'Nisha'],
    'Feedback': [
        '  Very GOOD Service!!!',
        'poor support,   not happy   ',
        'GREAT experience! will come again.',
        'okay   okay...',
        '  not   BAD',
        'Excellent care, excellent staff!',
        'good food and good ambience!',
        'Poor response and poor handling of issue',
        'Satisfied. But could be better.',
        'Good support... quick service.'
    ],
    'Rating': [5, 2, 5, 3, 2, 5, 4, 1, 3, 4]
}

# Step 2: Add more feedbacks from user
n = int(input("How many more feedbacks do you want to add? "))

start_sno = len(feedback_data['S_No']) + 1

for i in range(n):
    name = input("Enter Name: ")
    feedback = input("Enter Feedback: ")
    rating = int(input("Enter Rating (1-5): "))

    feedback_data['S_No'].append(start_sno)
    feedback_data['Name'].append(name)
    feedback_data['Feedback'].append(feedback)
    feedback_data['Rating'].append(rating)

    start_sno += 1


# Step 3: Text Cleaning
cleaned_feedbacks = []
punctuations = [".", ",", "!", "?"]

for fb in feedback_data['Feedback']:
    fb = fb.lower()  # convert to lowercase

    for p in punctuations:
        fb = fb.replace(p, "")  # remove punctuation

    fb = " ".join(fb.split())  # remove extra spaces
    cleaned_feedbacks.append(fb)

feedback_data['Feedback'] = cleaned_feedbacks


# Step 4: Word Count Function
def count_word_in_feedbacks(word):
    word = word.lower()
    count = 0
    for fb in feedback_data['Feedback']:
        if word in fb.split():
            count += 1
    return count

print("\n--- Word Count Insights ---")
print("Feedbacks containing 'good':", count_word_in_feedbacks("good"))
print("Feedbacks containing 'poor':", count_word_in_feedbacks("poor"))
print("Feedbacks containing 'excellent':", count_word_in_feedbacks("excellent"))


# Step 5: Final Summary & Insights
print("\n--- Final Cleaned Feedback Data ---")
print(feedback_data)


# Average Rating
avg_rating = sum(feedback_data['Rating']) / len(feedback_data['Rating'])
print("\nAverage Rating:", round(avg_rating, 2))


# Longest Feedback (word count)
word_counts = [len(fb.split()) for fb in feedback_data['Feedback']]
max_index = word_counts.index(max(word_counts))

print("\nLongest Feedback Comment:")
print("S_No:", feedback_data['S_No'][max_index])
print("Name:", feedback_data['Name'][max_index])
print("Feedback:", feedback_data['Feedback'][max_index])


# Unique Words Extraction
all_words = set()
for fb in feedback_data['Feedback']:
    for w in fb.split():
        all_words.add(w)

print("\nUnique Words Used in All Feedbacks:")
print(all_words)


# BONUS: Sort feedback by rating (descending)
sorted_data = sorted(zip(feedback_data['Rating'], feedback_data['Name'], feedback_data['Feedback']),
                     reverse=True)

print("\n--- Feedbacks Sorted by Rating ---")
for entry in sorted_data:
    print(entry)


